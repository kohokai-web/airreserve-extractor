<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airãƒªã‚¶ãƒ¼ãƒ–äºˆç´„è€…ä¸€è¦§æŠ½å‡ºãƒ„ãƒ¼ãƒ«</title>
    <style>
        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .header p {
            color: #666;
            font-size: 16px;
        }
        .step {
            margin: 25px 0;
            padding: 20px;
            border-left: 5px solid #007bff;
            background: linear-gradient(90deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 0 8px 8px 0;
        }
        .step h3 {
            margin-top: 0;
            color: #007bff;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin: 10px 0;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            transition: border-color 0.3s;
        }
        textarea:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }
        button {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px;
            transition: all 0.3s;
            font-weight: 600;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
        }
        .result {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(45deg, #d4edda, #c3e6cb);
            border-radius: 8px;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: linear-gradient(45deg, #f8d7da, #f5c6cb);
            border-color: #f5c6cb;
            color: #721c24;
        }
        .copy-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            font-size: 14px;
            padding: 8px 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        th {
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            font-weight: 600;
            color: #495057;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .instructions {
            background: linear-gradient(45deg, #fff3cd, #ffeaa7);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border: 1px solid #ffeaa7;
        }
        .instructions h3 {
            margin-top: 0;
            color: #856404;
        }
        .instructions ol li {
            margin: 8px 0;
            line-height: 1.6;
        }
        .instructions code {
            background-color: #f1f3f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .warning {
            background: #ffe8e8;
            border: 2px solid #ffcdd2;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .warning h4 {
            color: #d32f2f;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ Airãƒªã‚¶ãƒ¼ãƒ–äºˆç´„è€…ä¸€è¦§æŠ½å‡ºãƒ„ãƒ¼ãƒ«</h1>
            <p>äºˆç´„ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å…¨é …ç›®ã‚’ä¸€æ‹¬æŠ½å‡ºã—ã¦Excelç”¨CSVå½¢å¼ã§ä¿å­˜</p>
        </div>
        
        <div class="warning">
            <h4>âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …</h4>
            <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ç¤¾å†…ã®äºˆç´„ç®¡ç†æ¥­å‹™åŠ¹ç‡åŒ–ã®ãŸã‚ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚å€‹äººæƒ…å ±ã®å–ã‚Šæ‰±ã„ã«ã¯ååˆ†æ³¨æ„ã—ã€æŠ½å‡ºã—ãŸãƒ‡ãƒ¼ã‚¿ã¯æ¥­å‹™ç›®çš„ä»¥å¤–ã§ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚</p>
        </div>
        
        <div class="instructions">
            <h3>ğŸ“‹ ä½¿ç”¨æ‰‹é †</h3>
            <ol>
                <li><strong>Airãƒªã‚¶ãƒ¼ãƒ–ã®ç®¡ç†ç”»é¢</strong>ã§äºˆç´„ç®¡ç†ãƒšãƒ¼ã‚¸ã‚’é–‹ã</li>
                <li><strong>äºˆç´„ä¸€è¦§</strong>ã‚„<strong>äºˆç´„æ¤œç´¢</strong>ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹</li>
                <li><strong>F12ã‚­ãƒ¼</strong>ã§é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã</li>
                <li><strong>Elementsï¼ˆè¦ç´ ï¼‰ã‚¿ãƒ–</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li><strong>Ctrl+F</strong>ã§æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã‚’é–‹ãã€<code>tblReserveSearchResult</code>ã¾ãŸã¯<code>bookingSearchList</code>ã§æ¤œç´¢</li>
                <li>è¦‹ã¤ã‹ã£ãŸ<strong>ãƒ†ãƒ¼ãƒ–ãƒ«è¦ç´ å…¨ä½“</strong>ã‚’å³ã‚¯ãƒªãƒƒã‚¯</li>
                <li><strong>ã€ŒCopyã€â†’ã€ŒCopy outerHTMLã€</strong>ã‚’é¸æŠ</li>
                <li>ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«<strong>è²¼ã‚Šä»˜ã‘</strong>ã—ã¦ã€ŒæŠ½å‡ºé–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li><strong>å®Œå…¨ç‰ˆCSVä¿å­˜</strong>ãƒœã‚¿ãƒ³ã§å…¨é …ç›®å…¥ã‚ŠCSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
            </ol>
        </div>

        <div class="step">
            <h3>1ï¸âƒ£ HTMLã‚½ãƒ¼ã‚¹ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„</h3>
            <textarea id="htmlInput" placeholder="ã“ã“ã«Airãƒªã‚¶ãƒ¼ãƒ–ã®ç®¡ç†ç”»é¢ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ãŸHTMLã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„...

ã€æ¨å¥¨ã€‘äºˆç´„ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«:
<table class='tbl type-hAxisTtl' id='tblReserveSearchResult'>
  <tbody id='bookingSearchList'>
    <tr class='list_0'>
      ...äºˆç´„ãƒ‡ãƒ¼ã‚¿...
    </tr>
  </tbody>
</table>

ã€ä»–ã®å½¢å¼ã€‘
ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼: <ul class='cellList is-data'>...
è©³ç´°ç”»é¢: <section class='staffBookingDetailBalloon'>..."></textarea>
            <button onclick="extractNames()">ğŸ” æŠ½å‡ºé–‹å§‹</button>
            <button onclick="clearInput()">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
        </div>

        <div class="step">
            <h3>2ï¸âƒ£ æŠ½å‡ºçµæœ</h3>
            <div id="result"></div>
        </div>
    </div>

    <script>
        function extractNames() {
            const htmlInput = document.getElementById('htmlInput').value;
            const resultDiv = document.getElementById('result');
            
            if (!htmlInput || htmlInput.trim() === '') {
                resultDiv.innerHTML = '<div class="result error">âŒ HTMLã‚½ãƒ¼ã‚¹ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>';
                return;
            }
            
            console.log('å…¥åŠ›ã•ã‚ŒãŸHTMLæ–‡å­—åˆ—ã®é•·ã•:', htmlInput.length);
            console.log('å…¥åŠ›ã•ã‚ŒãŸHTMLï¼ˆæœ€åˆã®200æ–‡å­—ï¼‰:', htmlInput.substring(0, 200));
            
            try {
                // ãƒ‡ãƒ¼ã‚¿ç¨®åˆ¥ã‚’åˆ¤å®šï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æœ€å„ªå…ˆï¼‰
                const hasTableId = htmlInput.includes('tblReserveSearchResult');
                const hasBookingList = htmlInput.includes('bookingSearchList');
                const hasListRows = htmlInput.includes('class="list_0"') || htmlInput.includes('class="list_1"');
                const isTablePage = hasTableId || hasBookingList || hasListRows;
                
                const isDetailPage = htmlInput.includes('staffBookingDetailBalloon') || htmlInput.includes('äºˆç´„è©³ç´°');
                const isCalendarPage = htmlInput.includes('bookingUserName') && htmlInput.includes('cellList') && !isTablePage;
                
                console.log('åˆ¤å®šçµæœ:', {
                    hasTableId,
                    hasBookingList, 
                    hasListRows,
                    isTablePage,
                    isDetailPage,
                    isCalendarPage
                });
                
                let extractedData = [];
                
                if (isTablePage) {
                    console.log('ãƒ†ãƒ¼ãƒ–ãƒ«ãƒšãƒ¼ã‚¸ã¨ã—ã¦å‡¦ç†é–‹å§‹');
                    extractedData = extractTableData(htmlInput);
                    displayTableResults(extractedData, 'äºˆç´„ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«');
                } else if (isDetailPage) {
                    console.log('è©³ç´°ãƒšãƒ¼ã‚¸ã¨ã—ã¦å‡¦ç†é–‹å§‹');
                    extractedData = extractDetailPageData(htmlInput);
                    displayDetailResults(extractedData, 'è©³ç´°ç”»é¢');
                } else if (isCalendarPage) {
                    console.log('ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒšãƒ¼ã‚¸ã¨ã—ã¦å‡¦ç†é–‹å§‹');
                    extractedData = extractCalendarData(htmlInput);
                    displayCalendarResults(extractedData, 'ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”»é¢');
                } else {
                    console.log('å¯¾å¿œã—ã¦ã„ãªã„ãƒšãƒ¼ã‚¸å½¢å¼ã§ã™');
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <h4>âŒ å¯¾å¿œã—ã¦ã„ãªã„ãƒšãƒ¼ã‚¸å½¢å¼ã§ã™</h4>
                            <p>ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®ãƒšãƒ¼ã‚¸ã®HTMLã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼š</p>
                            <ul>
                                <li><strong>äºˆç´„ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ç”»é¢</strong>ï¼ˆæœ€ã‚‚è©³ç´°ãªæƒ…å ±ãŒå–å¾—å¯èƒ½ï¼‰</li>
                                <li><strong>äºˆç´„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”»é¢</strong>ï¼ˆè¤‡æ•°ã®äºˆç´„ãŒè¡¨ç¤ºã•ã‚Œã‚‹ç”»é¢ï¼‰</li>
                                <li><strong>äºˆç´„è©³ç´°ç”»é¢</strong>ï¼ˆå€‹åˆ¥ã®äºˆç´„ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚ã®è©³ç´°ç”»é¢ï¼‰</li>
                            </ul>
                            <button class="copy-btn" onclick="showDebugInfo()" style="background: #ffc107;">ğŸ” ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤º</button>
                            <div id="debugInfo" style="display: none; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 12px;"></div>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('ã‚¨ãƒ©ãƒ¼:', error);
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h4>âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h4>
                        <p>ã‚¨ãƒ©ãƒ¼å†…å®¹: ${error.message}</p>
                        <button class="copy-btn" onclick="showDebugInfo()" style="background: #ffc107;">ğŸ” ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤º</button>
                        <div id="debugInfo" style="display: none; margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 12px;"></div>
                    </div>
                `;
            }
        }
        
        function extractTableData(htmlString) {
            const tableData = [];
            const rowPattern = /<tr class="list_\d+">(.*?)<\/tr>/gs;
            const rowMatches = [...htmlString.matchAll(rowPattern)];
            
            console.log(`ãƒ†ãƒ¼ãƒ–ãƒ«è¡Œã‚’${rowMatches.length}ä»¶ç™ºè¦‹ã—ã¾ã—ãŸ`);
            
            rowMatches.forEach((match, index) => {
                const rowContent = match[1];
                const data = {};
                
                try {
                    // äºˆç´„ç•ªå·ã¨IDã‚’æŠ½å‡º
                    const bookingMatch = rowContent.match(/data-booking-id="([^"]+)"[^>]*>([^<]+)<\/a>/);
                    if (bookingMatch) {
                        data.bookingId = bookingMatch[1];
                        data.bookingNo = bookingMatch[2].trim();
                    }
                    
                    // äºˆç´„å—ä»˜æ—¥æ™‚ã‚’æŠ½å‡º
                    const reserveDateMatch = rowContent.match(/<td class="tblDateOfReserveTd"><span>([^<]+)<\/span><\/td>/);
                    data.reserveDate = reserveDateMatch ? reserveDateMatch[1].trim() : '';
                    
                    // å®Ÿæ–½ãƒ»åˆ©ç”¨æ—¥æ™‚ã‚’æŠ½å‡º
                    const useDateMatch = rowContent.match(/<td class="termCol"><span>([^<]+)<\/span><\/td>/);
                    data.useDate = useDateMatch ? useDateMatch[1].trim() : '';
                    
                    // äºˆç´„æ–¹æ³•ã‚’æŠ½å‡º
                    const methodMatch = rowContent.match(/<p class="bookingRoot\d*">ï¼ˆ([^ï¼‰]+)ï¼‰<\/p>/);
                    data.bookingMethod = methodMatch ? methodMatch[1] : '';
                    
                    // ã™ã¹ã¦ã®twoRowListã‚’æŠ½å‡º
                    const allTwoRowMatches = [...rowContent.matchAll(/<ul class="twoRowList"><li>([^<]*)<\/li><li>([^<]+)<\/li><\/ul>/g)];
                    
                    if (allTwoRowMatches.length >= 2) {
                        // 1ç•ªç›®ã®twoRowList: åå‰ãƒ»ãƒ•ãƒªã‚¬ãƒŠ
                        const nameMatch = allTwoRowMatches[0];
                        data.customerName = nameMatch[1].trim() || '-';
                        data.customerKana = nameMatch[2].trim().replace(/&nbsp;/g, ' ');
                        
                        // 2ç•ªç›®ã®twoRowList: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ»ãƒªã‚½ãƒ¼ã‚¹
                        const menuMatch = allTwoRowMatches[1];
                        data.menu = menuMatch[1].trim();
                        data.resource = menuMatch[2].trim();
                    }
                    
                    // åˆè¨ˆæ–™é‡‘ã‚’æŠ½å‡ºï¼ˆå˜ç‹¬ã®tdã®ä¸­èº«ï¼‰
                    const priceTdMatches = [...rowContent.matchAll(/<td>([^<]*)<\/td>/g)];
                    if (priceTdMatches.length >= 2) {
                        data.totalPrice = priceTdMatches[priceTdMatches.length - 2][1].trim() || '-';
                    }
                    
                    // äºˆç´„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æŠ½å‡º
                    const statusMatch = rowContent.match(/<span class="label[^"]*[^>]*>([^<]+)(?:<br>\s*([^<]+))?<\/span>/);
                    if (statusMatch) {
                        data.status = statusMatch[1].trim();
                        if (statusMatch[2]) {
                            data.status += ' (' + statusMatch[2].trim() + ')';
                        }
                    }
                    
                    // ãƒ‡ãƒ¼ã‚¿ãŒæœ‰åŠ¹ã‹ãƒã‚§ãƒƒã‚¯
                    if (data.bookingNo && (data.customerKana || data.customerName)) {
                        tableData.push(data);
                        console.log(`è¡Œ${index + 1}: ${data.customerKana} - ${data.bookingNo}`);
                    }
                    
                } catch (error) {
                    console.error(`è¡Œ${index + 1}ã®å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼:`, error);
                }
            });
            
            console.log(`æœ€çµ‚çš„ã«${tableData.length}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã—ãŸ`);
            return tableData;
        }
        
        function displayTableResults(data, source) {
            const resultDiv = document.getElementById('result');
            
            if (data.length > 0) {
                let resultHTML = `
                    <div class="result">
                        <h4>âœ… æŠ½å‡ºæˆåŠŸï¼ï¼ˆ${source}ï¼‰</h4>
                        <p><strong>äºˆç´„ä»¶æ•°:</strong> ${data.length}ä»¶</p>
                        <button class="copy-btn" onclick="downloadTableCSV()">ğŸ“Š å®Œå…¨ç‰ˆCSVä¿å­˜</button>
                        <button class="copy-btn" onclick="copyTableData()">ğŸ“‹ å®Œå…¨ç‰ˆãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼</button>
                        
                        <div style="overflow-x: auto; margin-top: 15px;">
                            <table style="min-width: 1200px; font-size: 12px;">
                                <thead>
                                    <tr>
                                        <th>No.</th>
                                        <th>äºˆç´„ç•ªå·</th>
                                        <th>ãŠå®¢æ§˜å</th>
                                        <th>ãƒ•ãƒªã‚¬ãƒŠ</th>
                                        <th>å®Ÿæ–½ãƒ»åˆ©ç”¨æ—¥æ™‚</th>
                                        <th>äºˆç´„å—ä»˜æ—¥æ™‚</th>
                                        <th>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</th>
                                        <th>ãƒªã‚½ãƒ¼ã‚¹</th>
                                        <th>åˆè¨ˆæ–™é‡‘</th>
                                        <th>äºˆç´„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                                        <th>äºˆç´„æ–¹æ³•</th>
                                        <th>äºˆç´„ID</th>
                                    </tr>
                                </thead>
                                <tbody>
                `;
                
                data.forEach((booking, index) => {
                    resultHTML += `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${booking.bookingNo || '-'}</td>
                            <td>${booking.customerName || '-'}</td>
                            <td>${booking.customerKana || '-'}</td>
                            <td>${booking.useDate || '-'}</td>
                            <td>${booking.reserveDate || '-'}</td>
                            <td>${booking.menu || '-'}</td>
                            <td>${booking.resource || '-'}</td>
                            <td>${booking.totalPrice || '-'}</td>
                            <td>${booking.status || '-'}</td>
                            <td>${booking.bookingMethod || '-'}</td>
                            <td>${booking.bookingId || '-'}</td>
                        </tr>
                    `;
                });
                
                resultHTML += `
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="result" style="margin-top: 20px; background: linear-gradient(45deg, #d1ecf1, #bee5eb);">
                        <h4>ğŸ‰ å®Œç’§ï¼ã™ã¹ã¦ã®æƒ…å ±ãŒå–å¾—ã§ãã¾ã—ãŸ</h4>
                        <p>ã“ã®äºˆç´„ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ã¯ã€å¿…è¦ãªæƒ…å ±ãŒã™ã¹ã¦æŠ½å‡ºã§ãã¾ã™ï¼</p>
                        <ul>
                            <li>âœ… <strong>æ­£ç¢ºãªåˆ©ç”¨æ—¥æ™‚</strong>ï¼ˆåˆ†å˜ä½ã¾ã§ï¼‰</li>
                            <li>âœ… <strong>ãƒ•ãƒªã‚¬ãƒŠ</strong></li>
                            <li>âœ… <strong>äºˆç´„ç•ªå·</strong></li>
                            <li>âœ… <strong>åˆè¨ˆæ–™é‡‘</strong></li>
                            <li>âœ… <strong>äºˆç´„å—ä»˜æ—¥æ™‚</strong></li>
                            <li>âœ… <strong>è©³ç´°ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</strong></li>
                        </ul>
                    </div>
                `;
                
                resultDiv.innerHTML = resultHTML;
                window.extractedTableData = data;
            } else {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h4>âŒ ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h4>
                        <p>äºˆç´„ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®HTMLã‚’æ­£ã—ãã‚³ãƒ”ãƒ¼ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>
                    </div>
                `;
            }
        }
        
        function downloadTableCSV() {
            if (!window.extractedTableData || window.extractedTableData.length === 0) {
                alert('âŒ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }
            
            const today = new Date();
            const dateString = today.getFullYear() + '-' + 
                             String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                             String(today.getDate()).padStart(2, '0');
            
            const csvHeaders = [
                'No.',
                'äºˆç´„ç•ªå·',
                'ãŠå®¢æ§˜å',
                'ãƒ•ãƒªã‚¬ãƒŠ',
                'å®Ÿæ–½ãƒ»åˆ©ç”¨æ—¥æ™‚',
                'äºˆç´„å—ä»˜æ—¥æ™‚',
                'ãƒ¡ãƒ‹ãƒ¥ãƒ¼',
                'ãƒªã‚½ãƒ¼ã‚¹',
                'åˆè¨ˆæ–™é‡‘ï¼ˆç¨è¾¼ï¼‰',
                'äºˆç´„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹',
                'äºˆç´„æ–¹æ³•',
                'äºˆç´„ID'
            ].join(',');
            
            const csvRows = window.extractedTableData.map((booking, index) => [
                index + 1,
                `"${booking.bookingNo || ''}"`,
                `"${booking.customerName || ''}"`,
                `"${booking.customerKana || ''}"`,
                `"${booking.useDate || ''}"`,
                `"${booking.reserveDate || ''}"`,
                `"${booking.menu || ''}"`,
                `"${booking.resource || ''}"`,
                `"${booking.totalPrice || ''}"`,
                `"${booking.status || ''}"`,
                `"${booking.bookingMethod || ''}"`,
                `"${booking.bookingId || ''}"`
            ].join(','));
            
            const csvContent = csvHeaders + '\n' + csvRows.join('\n');
            
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `airreserve_å®Œå…¨ç‰ˆäºˆç´„ä¸€è¦§_${dateString}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                alert('ğŸ“Š å®Œå…¨ç‰ˆCSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼\n\nã™ã¹ã¦ã®å¿…è¦é …ç›®ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚');
            }
        }
        
        function copyTableData() {
            if (!window.extractedTableData || window.extractedTableData.length === 0) {
                alert('âŒ ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }
            
            const headers = ['No.', 'äºˆç´„ç•ªå·', 'ãŠå®¢æ§˜å', 'ãƒ•ãƒªã‚¬ãƒŠ', 'å®Ÿæ–½ãƒ»åˆ©ç”¨æ—¥æ™‚', 'äºˆç´„å—ä»˜æ—¥æ™‚', 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼', 'ãƒªã‚½ãƒ¼ã‚¹', 'åˆè¨ˆæ–™é‡‘ï¼ˆç¨è¾¼ï¼‰', 'äºˆç´„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹', 'äºˆç´„æ–¹æ³•', 'äºˆç´„ID'];
            const data = window.extractedTableData.map((booking, index) => [
                index + 1,
                booking.bookingNo || '',
                booking.customerName || '',
                booking.customerKana || '',
                booking.useDate || '',
                booking.reserveDate || '',
                booking.menu || '',
                booking.resource || '',
                booking.totalPrice || '',
                booking.status || '',
                booking.bookingMethod || '',
                booking.bookingId || ''
            ]);
            
            const textData = [headers.join('\t'), ...data.map(row => row.join('\t'))].join('\n');
            
            navigator.clipboard.writeText(textData).then(() => {
                alert('ğŸ“‹ å®Œå…¨ç‰ˆãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\nExcelã«è²¼ã‚Šä»˜ã‘ã§ãã¾ã™ã€‚');
            }).catch(err => {
                console.error('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—:', err);
                alert('âŒ ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ');
            });
        }
        
        function clearInput() {
            document.getElementById('htmlInput').value = '';
            document.getElementById('result').innerHTML = '';
        }
        
        window.onload = function() {
            console.log('ğŸ¯ Airãƒªã‚¶ãƒ¼ãƒ–äºˆç´„è€…ä¸€è¦§æŠ½å‡ºãƒ„ãƒ¼ãƒ«ï¼ˆå®Œå…¨ä¿®æ­£ç‰ˆï¼‰ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
        };
    </script>
</body>
</html>
